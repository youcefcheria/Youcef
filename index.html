
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>farsi youcef</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<style>
  body {
    background: #0a1c3a;
    color: white;
    font-family: sans-serif;
    text-align: center;
    margin: 0;
    padding: 0;
  }
  .site-logo {
    font-family: "Arial Black", sans-serif;
    font-size: 55px;
    font-weight: bold;
    color: #3cfcb3;
    margin: 20px 0;
    display: inline-block;
    padding: 10px 20px;
    background: rgba(0,60,50,0.25);
    border-radius: 15px;
    box-shadow: 0 4px 12px rgba(60,252,179,0.3);
  }
  .search-box { margin: 15px; }
  input { padding: 10px; border-radius: 10px; border: none; width: 70%; max-width: 250px; }
  button { padding: 10px 15px; border-radius: 10px; border: none; background: #3cfcb3; cursor: pointer; font-weight: bold; }
  button:hover { background: #2abf8b; }

  .video-card { background: #13274a; margin: 10px auto; padding: 10px; border-radius: 12px; width: 95%; max-width: 800px; position: relative; }
  video { border-radius: 10px; width: 100%; height: 380px; background:black; }
  @media (max-width:600px){ video{height:220px;} .site-logo{font-size:36px;padding:6px 12px;} }

  .logo-overlay { position:absolute; top:10px; right:10px; width:55px; height:55px; background:#0077ff; border-radius:50%; display:flex; justify-content:center; align-items:center; font-size:14px; font-weight:bold; color:white; font-family:"Arial Black",sans-serif; box-shadow:0 0 6px rgba(0,119,255,0.7); z-index:10; pointer-events:none; }

  .controls { margin-top:10px; }
  .controls button, .controls select { margin:5px; padding:8px 12px; border-radius:8px; border:none; cursor:pointer; font-weight:bold; }
  .controls button { background:#3cfcb3; } .controls button:hover{background:#2abf8b;}
  #downloadBtn{background:#2ecc71;} #downloadBtn:hover{background:#27ae60;}

  .video-list { max-height:350px; overflow-y:auto; margin-top:15px; padding:10px; background:#0f1e3f; border-radius:12px; display:flex; flex-direction:column; gap:10px; }
  .video-list-item { display:flex; align-items:center; background:#1a2b4d; border-radius:8px; padding:5px; cursor:pointer; transition:all 0.2s; }
  .video-list-item.active { border:2px solid #ff4da6; box-shadow:0 0 8px rgba(255,77,166,0.6); }
  .video-list-item:hover{ border:2px solid #3cfcb3; box-shadow:0 0 6px rgba(60,252,179,0.5); }
  .video-list img{ width:110px; border-radius:6px; margin-left:10px; }
  .video-title{ font-size:14px; color:#ccc; text-align:right; flex:1; }
  .current-quality{ font-size:13px; color:#3cfcb3; margin-bottom:5px; }

  .no-results{ margin:20px; color:#ff4d4d; font-size:18px; font-weight:bold; }

  .loading-container{ display:none; margin:15px; text-align:center; color:#3cfcb3; font-size:14px; }
  .loading-spinner{ border:4px solid #3cfcb3; border-top:4px solid transparent; border-radius:50%; width:28px; height:28px; margin:0 auto 8px; animation:spin 1s linear infinite; }
  @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }

  #downloadOptions{ display:none; margin-top:8px; padding:8px; background:#1a2b4d; border-radius:8px; }
  #downloadOptions a{ color:#3cfcb3; padding:5px; text-decoration:none; border-radius:6px; display:block; margin:3px 0; }
  #downloadOptions a:hover{ background:#2abf8b; color:white; }
</style>
</head>
<body>
<h1 class="site-logo">Farsi Youcef</h1>

<div class="search-box">
  <input type="text" id="search" placeholder="اكتب للبحث في الأفلام">
  <button onclick="startSearch()"><i class="fas fa-search"></i> بحث</button>
</div>

<div class="video-card" id="results">
  <div class="logo-overlay">Farsi</div>
  <video id="videoPlayer" controls preload="metadata" poster="" loading="lazy">
    <source id="videoSource" src="" type="video/mp4">
    متصفحك لا يدعم الفيديو.
  </video>
  <div id="currentQualityDisplay" class="current-quality">الجودة: تلقائي</div>
  <h3 id="videoTitle">اختر فيديو</h3>
  <div class="controls">
    <button onclick="toggleFullscreen()"><i class="fas fa-expand"></i> تكبير</button>
    <select id="qualitySelect" onchange="changeQuality()">
      <option value="auto">⚡ تلقائي</option>
      <option value="360">360p</option>
      <option value="480">480p</option>
      <option value="720">720p</option>
    </select>
    <button id="downloadBtn" onclick="toggleDownloadOptions()"><i class="fas fa-download"></i> تحميل</button>
  </div>
  <div id="downloadOptions"></div>
</div>

<div class="video-list" id="videoList"></div>
<div class="loading-container" id="loading">
  <div class="loading-spinner"></div>
  <div>جارٍ التحميل...</div>
</div>

<script>
const state={currentPage:1,currentQuery:"",currentVideoId:"",currentTitle:"",files:[],currentQuality:"auto",loading:false};

async function fetchArchive(query,page=1){
  const url=`https://archive.org/advancedsearch.php?q=${encodeURIComponent(query)}+AND+mediatype:(movies)&fl[]=identifier&fl[]=title&sort[]=downloads+desc&rows=30&page=${page}&output=json`;
  const res=await fetch(url); const data=await res.json(); return data.response.docs;
}

async function fetchFiles(id){
  const url=`https://archive.org/metadata/${id}`;
  const res=await fetch(url); const data=await res.json();
  return data.files.filter(f=>f.format==="MPEG4"||f.name.endsWith(".mp4"));
}

async function startSearch(){
  state.currentPage=1;
  document.getElementById("videoList").innerHTML="";
  const val=document.getElementById("search").value.trim();
  if(!val) return;
  state.currentQuery=val;
  document.getElementById("loading").style.display="block";
  const docs=await fetchArchive(state.currentQuery,state.currentPage);
  document.getElementById("loading").style.display="none";
  showVideos(docs);
}

async function loadMore(){
  if(state.loading) return;
  state.loading=true;
  document.getElementById("loading").style.display="block";
  state.currentPage++;
  const docs=state.currentQuery?await fetchArchive(state.currentQuery,state.currentPage):await fetchArchive("mediatype:(movies)",state.currentPage);
  showVideos(docs); 
  state.loading=false; 
  document.getElementById("loading").style.display="none";
}

function showVideos(docs){
  const listDiv=document.getElementById("videoList");
  if(docs.length===0&&state.currentPage===1){ listDiv.innerHTML=`<div class="no-results">❌ لم يتم العثور على أي فيديوهات</div>`; return; }
  docs.forEach((doc)=>{
    const div=document.createElement("div"); div.classList.add("video-list-item");
    div.onclick=()=>changeVideo(doc.identifier,doc.title,div);
    div.innerHTML=`<img src="https://archive.org/services/img/${doc.identifier}" alt="${doc.title}" loading="lazy"><div class="video-title">${doc.title}</div>`;
    listDiv.appendChild(div);
  });
}

async function changeVideo(id,title,element){
  state.currentVideoId=id;
  state.currentTitle=title;
  document.getElementById("videoTitle").innerText=title;
  state.files=await fetchFiles(id);
  prepareVideo();
  document.querySelectorAll(".video-list-item").forEach(el=>el.classList.remove("active"));
  if(element) element.classList.add("active");
}

function prepareVideo(){
  const player=document.getElementById("videoPlayer");
  const source=document.getElementById("videoSource");
  let file;
  if(state.currentQuality==="auto"){ file=state.files[0]; }
  else{ file=state.files.find(f=>f.name.includes(state.currentQuality))||state.files[0]; }
  if(file){ 
    source.src=`https://archive.org/download/${state.currentVideoId}/${file.name}`;
    player.poster=`https://archive.org/services/img/${state.currentVideoId}`;
    player.load(); 
  }
  document.getElementById("currentQualityDisplay").innerText="الجودة: "+(state.currentQuality==="auto"?"تلقائي":state.currentQuality+"p");
  buildDownloadOptions();
}

function changeQuality(){ state.currentQuality=document.getElementById("qualitySelect").value; prepareVideo(); }

function toggleFullscreen(){ const video=document.getElementById("videoPlayer"); if(video.requestFullscreen) video.requestFullscreen(); }

function buildDownloadOptions(){
  const div=document.getElementById("downloadOptions");
  div.innerHTML="";
  state.files.forEach(f=>{
    const a=document.createElement("a");
    a.href=`https://archive.org/download/${state.currentVideoId}/${f.name}`;
    a.textContent=`تحميل (${f.name})`;
    a.download=f.name;
    div.appendChild(a);
  });
}

function toggleDownloadOptions(){
  const div=document.getElementById("downloadOptions");
  div.style.display=(div.style.display==="block")?"none":"block";
}

async function loadDefaultVideos(){ 
  document.getElementById("loading").style.display="block"; 
  const docs=await fetchArchive("mediatype:(movies)",state.currentPage); 
  document.getElementById("loading").style.display="none"; 
  showVideos(docs); 
}

document.getElementById("videoList").addEventListener("scroll",async function(){ const list=this; if(list.scrollTop+list.clientHeight>=list.scrollHeight-40) await loadMore(); });

window.onload=loadDefaultVideos;
</script>
</body>
</html>
